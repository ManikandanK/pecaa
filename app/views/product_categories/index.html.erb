<%= javascript_include_tag 'jquery.jeditable'%>

  <div class="content-section categoryMain">
    <div class="pages-main">
      <div class="pages-wrapper">
        <div class="usersLeftPane left">
          <div class="title">Categories<span class="help"><a href="#"></a></span></div>
        </div>
        <div class="searchContent right">
          <%= form_tag search_site_product_categories_path(@site) do %>
            <input type="text" id="query" name="query" placeholder="search"><span class="searchIcon"><a href="#"></a></span>
	    	 <% end %>
	    </div>
        <div class="site-users left">
          <div class="page-data clear">
            <div class="userGrid productGrid">
              <div class="userGridHeader">
                <ul class="ConLibraHeads">
                  <li> <span class="userName">Category Name</span> <span class="group">Price Modifier</span> <span class="created">Enabled</span> </li>
                </ul>
              </div>
              <div class="userGridBody">
                <div id="products1">
                  <div class="scrollbar">
                    <div class="track">
                      <div class="thumb">
                        <div class="end"></div>
                      </div>
                    </div>
                  </div>
                  <div class="viewport">
                    <div class="shadows"><span class="topShadow"></span><span class="bottomShadow"></span></div>
                    <div class="overview">
                      <ul class="ConLibra">
                        <% @product_categories.each do |pc| %>
                          <li class="selected"> 
                            <span class="userName PcName" id="<%=pc.id%>">
                              <%=pc.name%>
                            </span>
                            <span class="group">
                              <span>
                                <a href="#"><img src="/assets/btn_deleteActive.png" width="40" height="20"></a>
                              </span>
                              <span>
                                <input name="" type="text" class="modifierTextBg" value="<%=pc.price_modifier_value%> <%=pc.price_modifier %>" size="4" maxlength="6">
                              </span>
                            </span> 
                            <span class="status">
                              <a rel="<%=pc.is_active%>"  href="<%=update_pc_site_product_category_path(@site, pc, :product_category=>{:is_active => !(pc.is_active)})%>" class= <%=pc.is_active ? 'on' : 'off' %>>
                              </a>
                            </span>
                            <span class="removeBtn">
                              <%= render :partial => 'shared/alert_box', :locals => {:obj => pc,
                                 :path => delete_site_product_category_path(@site, pc),
                                 :img_path => "/assets/btnDelete.png"}%> 
                            </span>
                          </li>
                        <% end %>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div class="userGridFooter"></div>
            </div>
          </div>
          <div class="addNewUserBtn">
            <a class="addNewUser" rel="facebox" href="<%=new_site_product_category_path(@site)%>" class="addProductBtn">add product category</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
	
	$(document).ready(function(){
		$('#products1').tinyscrollbar();
		$(".ConLibra li:even").addClass("alt");

    // $("ul.ConLibra li").click(function(){
    //  var $this = $(this);
    //  //$this.parent().find('.misc img').hide();
    //  
    //  if(!$this.hasClass("selected")){
    //    $("ul.ConLibra li").removeClass("selected");
    //    $("ul.ConLibra li").find('.pointer').hide();
    //    $this.addClass("selected");
    //    $this.find('.pointer').show();
    //    //$this.find('.misc img').show();
    //  }
    //       return false;
    //  
    // })
    
    var edittext_url = "<%=update_name_site_product_categories_path(@site)%>";
    get_Inline_editors_ready('PcName', edittext_url)    
    
	})
</script>
<script type="text/javascript" src="/assets/alert_box.js"></script>
<script>
$("span.status a").live("click", function(){
  var link = $(this);
  $.ajax({
    type: "GET",
    url: link.attr('href'),
    success: function(result){        
      var new_rel = link.attr('rel') == 'true' ? 'false' : 'true';
      var new_link = (link.attr('rel') == 'true' ? link.attr('href').replace('false', 'true') : link.attr('href').replace('true', 'false'));
      var new_class =  link.attr('class') == 'on' ? 'off' : 'on';
      link.parent().html("<a rel="+ new_rel  + " href="+ new_link +" class="+ new_class +"></a>")
  }});
 return false;
});
</script>
